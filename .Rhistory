ggsave(file= "ScoreCurve.eps", plot = last_plot(), h=4, w=8, dpi=320, units = c('in'), device = "eps")
dev.off()
##########################################################################################################################
unique <- split(resT, list(resT$group1, resT$group2))
unique <- unique[sapply(unique, function(x) dim(x)[1]) > 0]
i=1
while (i<1+(length(unique))){
loaded_df <- as.data.frame(unique[i])
fullname <- colnames(loaded_df)[2]
name <- gsub('..y.', '', fullname)
name <- gsub('\\.', '_', name)
group1 <- unique(loaded_df[3])
group1 <- as.list(group1[1])
group2 <- unique(loaded_df[4])
group2 <- as.list(group2[1])
Mean1 <- Mean[Mean$TGS == group1 | Mean$TGS == group2,]
MaxScores1 <- aggregate(Score ~ Day, data = Mean1, max)
colnames(loaded_df)[1] <- 'Day'
colnames(loaded_df)[5] <- 'p'
resTloaded <- merge(loaded_df, MaxScores1, by.x = 'Day', by.y = 'Day')
if (missing(alt.heights)){
resTloaded$p.adj.star1 <- ifelse(resTloaded$p < 0.05, '*', "")
resTloaded$p.adj.star1.height <- resTloaded$Score + 0.45
resTloaded$p.adj.star2 <- ifelse(resTloaded$p < 0.01, '*', "")
resTloaded$p.adj.star2.height <- resTloaded$Score + 0.6
resTloaded$p.adj.star3 <- ifelse(resTloaded$p < 0.001, '*', "")
resTloaded$p.adj.star3.height <- resTloaded$Score + 0.75
} else {
resA$p.adj.star1 <- ifelse(resA$p < 0.05, '*', "")
resA$p.adj.star1.height <- resA$max + alt.heights[1]
resA$p.adj.star2 <- ifelse(resA$p < 0.01, '*', "")
resA$p.adj.star2.height <- resA$max +  alt.heights[2]
resA$p.adj.star3 <- ifelse(resA$p < 0.001, '*', "")
resA$p.adj.star3.height <- resA$max +  alt.heights[3]
}
EAElongloaded <- EAElong[EAElong$TGS == group1 | EAElong$TGS == group2,]
resTloaded$Day
ggob = ggline(EAElongloaded,
y = "Score",
x = "Day", group = "TGS", add = "mean_se", width = 5,
color = "TGS")
ggob = ggob + scale_colour_manual(values = colormatch)
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resTloaded$Day - min(EAElong$Day) + 1, y=resTloaded$p.adj.star1.height, label=resTloaded$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resTloaded$Day - min(EAElong$Day) + 1, y=resTloaded$p.adj.star2.height, label=resTloaded$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resTloaded$Day - min(EAElong$Day) + 1, y=resTloaded$p.adj.star3.height, label=resTloaded$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8))
print(ggob)
ggsave(paste0(name, "ScoreCurve.eps"), plot = last_plot(), h=4, w=8, dpi=320, units = c('in'), device = "eps")
dev.off()
# dfcolor<- as.data.frame(colormatch)
# colormatchloaded <- dfcolor[rownames(dfcolor) == (unique(EAElongloaded$TGS)),]
# colorsloaded <- as.data.frame(colormatchloaded)
# ggob = ggob + scale_colour_manual(values = colortemp)
i = i+1
}
}
ScoreCurve <- function(data, title, colormatch, stats, alt.heights){
require(ggplot2)
require(ggpubr)
require(dplyr)
require(tidyr)
dft = function(df) {
tdf = t(df)
colnames(tdf) = rownames(df)
rownames(tdf) = colnames(df)
return(data.frame(tdf, check.names=FALSE, stringsAsFactors=FALSE))
}
EAEdata <- na.omit(data)
colnames(EAEdata) <- gsub('X', '', colnames(EAEdata))
EAEdata$TGS <- paste(EAEdata$Treatment, EAEdata$Sex)
EAElong <- EAEdata %>% gather('Day', 'Score', -'Treatment', -"Sex", -"TGS")
EAElong$Day <- as.numeric(EAElong$Day)
EAElong$Score <- as.numeric(EAElong$Score)
if(missing(stats)){
resA <- compare_means(Score ~ Treatment, EAElong, method = 'kruskal.test', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 'wilcox.test', group.by = c("Day"), paired = F)
} else if (stats == 'parametric'){
resA <- compare_means(Score ~ Treatment, EAElong, method = 'anova', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 't.test', group.by = c("Day"), paired = F)
} else {
resA <- compare_means(Score ~ Treatment, EAElong, method = 'kruskal.test', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 'wilcox.test', group.by = c("Day"), paired = F)
}
write.csv(resT, file = "Two-Group-Comparisons.csv")
write.csv(resA, file = "All-Group-Comparisons.csv")
Mean <- EAElong %>%
group_by(Day, Treatment) %>%
summarise_all(funs(mean))
MaxScores <- aggregate(Score ~ Day, data = Mean, max)
resA <- merge(resA, MaxScores, by=c('Day', 'Day'))
colnames(resA)[colnames(resA)=="Score"] <- "max"
resA <- resA[resA$p.adj != 'NaN', ]
if (missing(alt.heights)){
resA$p.adj.star1 <- ifelse(resA$p < 0.05, '*', "")
resA$p.adj.star1.height <- resA$max + 0.5
resA$p.adj.star2 <- ifelse(resA$p < 0.01, '*', "")
resA$p.adj.star2.height <- resA$max + 0.65
resA$p.adj.star3 <- ifelse(resA$p < 0.001, '*', "")
resA$p.adj.star3.height <- resA$max + 0.80
} else {
resA$p.adj.star1 <- ifelse(resA$p < 0.05, '*', "")
resA$p.adj.star1.height <- resA$max + alt.heights[1]
resA$p.adj.star2 <- ifelse(resA$p < 0.01, '*', "")
resA$p.adj.star2.height <- resA$max +  alt.heights[2]
resA$p.adj.star3 <- ifelse(resA$p < 0.001, '*', "")
resA$p.adj.star3.height <- resA$max +  alt.heights[3]
}
resA$Day <- as.numeric(resA$Day)
EAElong$Day <- as.numeric(EAElong$Day)
unique2 <- unique(EAElong$Treatment)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = colormatch)
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
ggsave(file= "ScoreCurve.eps", plot = last_plot(), h=4, w=8, dpi=320, units = c('in'), device = "eps")
dev.off()
##########################################################################################################################
unique <- split(resT, list(resT$group1, resT$group2))
unique <- unique[sapply(unique, function(x) dim(x)[1]) > 0]
i=1
while (i<1+(length(unique))){
loaded_df <- as.data.frame(unique[i])
fullname <- colnames(loaded_df)[2]
name <- gsub('..y.', '', fullname)
name <- gsub('\\.', '_', name)
group1 <- unique(loaded_df[3])
group1 <- as.list(group1[1])
group2 <- unique(loaded_df[4])
group2 <- as.list(group2[1])
Mean1 <- Mean[Mean$Treatment == group1 | Mean$Treatment == group2,]
MaxScores1 <- aggregate(Score ~ Day, data = Mean1, max)
colnames(loaded_df)[1] <- 'Day'
colnames(loaded_df)[5] <- 'p'
resTloaded <- merge(loaded_df, MaxScores1, by.x = 'Day', by.y = 'Day')
if (missing(alt.heights)){
resTloaded$p.adj.star1 <- ifelse(resTloaded$p < 0.05, '*', "")
resTloaded$p.adj.star1.height <- resTloaded$Score + 0.45
resTloaded$p.adj.star2 <- ifelse(resTloaded$p < 0.01, '*', "")
resTloaded$p.adj.star2.height <- resTloaded$Score + 0.6
resTloaded$p.adj.star3 <- ifelse(resTloaded$p < 0.001, '*', "")
resTloaded$p.adj.star3.height <- resTloaded$Score + 0.75
} else {
resA$p.adj.star1 <- ifelse(resA$p < 0.05, '*', "")
resA$p.adj.star1.height <- resA$max + alt.heights[1]
resA$p.adj.star2 <- ifelse(resA$p < 0.01, '*', "")
resA$p.adj.star2.height <- resA$max +  alt.heights[2]
resA$p.adj.star3 <- ifelse(resA$p < 0.001, '*', "")
resA$p.adj.star3.height <- resA$max +  alt.heights[3]
}
EAElongloaded <- EAElong[EAElong$Treatment == group1 | EAElong$Treatment == group2,]
resTloaded$Day
ggob = ggline(EAElongloaded,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = colormatch)
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resTloaded$Day - min(EAElong$Day) + 1, y=resTloaded$p.adj.star1.height, label=resTloaded$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resTloaded$Day - min(EAElong$Day) + 1, y=resTloaded$p.adj.star2.height, label=resTloaded$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resTloaded$Day - min(EAElong$Day) + 1, y=resTloaded$p.adj.star3.height, label=resTloaded$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8))
print(ggob)
ggsave(paste0(name, "ScoreCurve.eps"), plot = last_plot(), h=4, w=8, dpi=320, units = c('in'), device = "eps")
dev.off()
# dfcolor<- as.data.frame(colormatch)
# colormatchloaded <- dfcolor[rownames(dfcolor) == (unique(EAElongloaded$TGS)),]
# colorsloaded <- as.data.frame(colormatchloaded)
# ggob = ggob + scale_colour_manual(values = colortemp)
i = i+1
}
}
Edata <- read.csv("/Users/colemaguire/Desktop/Score_Curve_Input_Template.csv")
Edata <- na.omit(Edata)
Edata <- data.frame(Edata[,-1], row.names=Edata[,1])
data <- Edata
# rownames(Edata) <- Edata[,1]
# Edata <- Edata[,-1]
setwd("/Users/colemaguire/Desktop/test/")
colormatch = c("Alcohol Male" = 'dodgerblue', "Alcohol Female"='red',"Control Male"= 'darkblue',"Control Female"= 'darkred')
title = 'test'
ScoreCurve(Edata, colormatch = colors2, title = 'test')
data <- Edata
EAEdata <- na.omit(data)
colnames(EAEdata) <- gsub('X', '', colnames(EAEdata))
EAEdata$TGS <- paste(EAEdata$Treatment, EAEdata$Sex)
EAElong <- EAEdata %>% gather('Day', 'Score', -'Treatment', -"Sex", -"TGS")
EAElong$Day <- as.numeric(EAElong$Day)
EAElong$Score <- as.numeric(EAElong$Score)
if(missing(stats)){
resA <- compare_means(Score ~ Treatment, EAElong, method = 'kruskal.test', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 'wilcox.test', group.by = c("Day"), paired = F)
} else if (stats == 'parametric'){
resA <- compare_means(Score ~ Treatment, EAElong, method = 'anova', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 't.test', group.by = c("Day"), paired = F)
} else {
resA <- compare_means(Score ~ Treatment, EAElong, method = 'kruskal.test', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 'wilcox.test', group.by = c("Day"), paired = F)
}
resA <- compare_means(Score ~ Treatment, EAElong, method = 'kruskal.test', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 'wilcox.test', group.by = c("Day"), paired = F)
Mean <- EAElong %>%
group_by(Day, Treatment) %>%
summarise_all(funs(mean))
MaxScores <- aggregate(Score ~ Day, data = Mean, max)
resA <- merge(resA, MaxScores, by=c('Day', 'Day'))
colnames(resA)[colnames(resA)=="Score"] <- "max"
resA <- resA[resA$p.adj != 'NaN', ]
resA$p.adj.star1 <- ifelse(resA$p < 0.05, '*', "")
resA$p.adj.star1.height <- resA$max + 0.5
resA$p.adj.star2 <- ifelse(resA$p < 0.01, '*', "")
resA$p.adj.star2.height <- resA$max + 0.65
resA$p.adj.star3 <- ifelse(resA$p < 0.001, '*', "")
resA$p.adj.star3.height <- resA$max + 0.80
resA$Day <- as.numeric(resA$Day)
EAElong$Day <- as.numeric(EAElong$Day)
unique2 <- unique(EAElong$Treatment)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = colormatch)
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
View(EAElong)
resA$Day <- as.numeric(resA$Day)
EAElong$Day <- as.numeric(EAElong$Day)
unique2 <- unique(EAElong$Treatment)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = colormatch)
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
quartz()
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = colormatch)
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = c(("Alcohol", "red"), ("Control", "black")))
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = c(("Alcohol" = "red"), ("Control" = "black")))
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = c(("Alcohol" = "red"), ("Control" = "black")))
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle("Day 10 Alcohol")
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
Edata <- read.csv("/Users/colemaguire/Desktop/Melamed/Day10-alcohol/Day10.csv")
Edata <- na.omit(Edata)
Edata <- data.frame(Edata[,-1], row.names=Edata[,1])
Edata <- read.csv("/Users/colemaguire/Desktop/Melamed/Day10-alcohol/Day10.csv")
Edata <- na.omit(Edata)
Edata <- dft(Edata)
u
dft = function(df) {
tdf = t(df)
colnames(tdf) = rownames(df)
rownames(tdf) = colnames(df)
return(data.frame(tdf, check.names=FALSE, stringsAsFactors=FALSE))
}
Edata <- dft(Edata)
Edata <- data.frame(Edata[-1,], col.names=Edata[1,])
data <- Edata[1:41,]
View(data)
data <- Edata[1:25,1:41]
data <- Edata[1:24,1:41]
require(ggplot2)
require(ggpubr)
require(dplyr)
require(tidyr)
dft = function(df) {
tdf = t(df)
colnames(tdf) = rownames(df)
rownames(tdf) = colnames(df)
return(data.frame(tdf, check.names=FALSE, stringsAsFactors=FALSE))
}
EAEdata <- na.omit(data)
colnames(EAEdata) <- gsub('X', '', colnames(EAEdata))
EAEdata$TGS <- paste(EAEdata$Treatment, EAEdata$Sex)
EAElong <- EAEdata %>% gather('Day', 'Score', -'Treatment', -"Sex", -"TGS")
EAElong$Day <- as.numeric(EAElong$Day)
View(EAElong)
View(EAEdata)
Edata <- read.csv("/Users/colemaguire/Desktop/Melamed/Day10-alcohol/Day10.csv")
Edata <- na.omit(Edata)
Edata <- dft(Edata)
Edata <- data.frame(Edata[-1,], col.names=Edata[1,])
View(Edata)
data <- Edata[1:24,1:43]
data <- data[,-42]
Edata <- read.csv("/Users/colemaguire/Desktop/Melamed/Day10-alcohol/Day10.csv")
Edata <- na.omit(Edata)
Edata <- dft(Edata)
Edata <- data.frame(Edata[-1,], col.names=Edata[1,])
data <- Edata[1:24,1:44]
data <- data[,-42]
colnames(data)[42] <- 'Sex'
colnames(data)[43] <- 'Treatment'
require(ggplot2)
require(ggpubr)
require(dplyr)
require(tidyr)
dft = function(df) {
tdf = t(df)
colnames(tdf) = rownames(df)
rownames(tdf) = colnames(df)
return(data.frame(tdf, check.names=FALSE, stringsAsFactors=FALSE))
}
EAEdata <- na.omit(data)
colnames(EAEdata) <- gsub('X', '', colnames(EAEdata))
EAEdata$TGS <- paste(EAEdata$Treatment, EAEdata$Sex)
EAElong <- EAEdata %>% gather('Day', 'Score', -'Treatment', -"Sex", -"TGS")
EAElong$Day <- as.numeric(EAElong$Day)
EAElong$Score <- as.numeric(EAElong$Score)
resA <- compare_means(Score ~ Treatment, EAElong, method = 'kruskal.test', group.by = c("Day"), paired = F)
resT <- compare_means(Score ~ Treatment, EAElong, method = 'wilcox.test', group.by = c("Day"), paired = F)
write.csv(resT, file = "Two-Group-Comparisons.csv")
write.csv(resA, file = "All-Group-Comparisons.csv")
Mean <- EAElong %>%
group_by(Day, Treatment) %>%
summarise_all(funs(mean))
MaxScores <- aggregate(Score ~ Day, data = Mean, max)
resA <- merge(resA, MaxScores, by=c('Day', 'Day'))
colnames(resA)[colnames(resA)=="Score"] <- "max"
resA <- resA[resA$p.adj != 'NaN', ]
resA$p.adj.star1 <- ifelse(resA$p < 0.05, '*', "")
resA$p.adj.star1.height <- resA$max + 0.5
resA$p.adj.star2 <- ifelse(resA$p < 0.01, '*', "")
resA$p.adj.star2.height <- resA$max + 0.65
resA$p.adj.star3 <- ifelse(resA$p < 0.001, '*', "")
resA$p.adj.star3.height <- resA$max + 0.80
resA$Day <- as.numeric(resA$Day)
EAElong$Day <- as.numeric(EAElong$Day)
unique2 <- unique(EAElong$Treatment)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = c(("Alcohol" = "red"), ("Control" = "black")))
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle(title)
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
ggob = ggline(EAElong,
y = "Score",
x = "Day", group = "Treatment", add = "mean_se", width = 5,
color = "Treatment")
ggob = ggob + scale_colour_manual(values = c(("Alcohol" = "red"), ("Control" = "black")))
ggob = ggob + ylab('Disease Score')
ggob = ggob + ggtitle("Day 10 Alcohol")
# ggob = ggob + labs(fill = "Treatment Group and Sex")
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
ggob = ggob + annotate('text', x= resA$Day - min(EAElong$Day) + 1, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star1.height, label=resA$p.adj.star1, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star2.height, label=resA$p.adj.star2, size=6)
# ggob = ggob + annotate('text', x= resA$Day, y=resA$p.adj.star3.height, label=resA$p.adj.star3, size=6)
ggob = ggob + theme(
axis.text.x.bottom = element_text(size=8)
)
#pdf(paste0(title, ".pdf"), width=8, height=4, res = 300)
print(ggob)
